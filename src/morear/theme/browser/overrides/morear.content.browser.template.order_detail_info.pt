<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    xmlns:i18n="http://xml.zope.org/namespaces/i18n"
    lang="en"
    metal:use-macro="context/main_template/macros/master"
    i18n:domain="morear.content">
<body>


<metal:content-core fill-slot="content-core">
<metal:content-core define-macro="content-core"
                    tal:define="toc context/table_of_contents|nothing;">

<?python
from plone import api
import json
portal = api.portal.get()
orderId = view.request.form.get('id')
?>

<h3>訂單編號：${orderId}</h3>
<table>

    <tr><h4>訂單品項</h4>
        <ul tal:repeat="item python:view.getOrderItem(orderId)">
            <li tal:repeat="value item" tal:switch="python:view.orderItemList[repeat['value'].index]">
                <tal:uid case="string:p_UID">
                    <b>${python:view.orderItemList[repeat['value'].index]}</b>: ${python:api.content.find(UID=value)[0].Title}
                </tal:uid>
                <tal:sn case="string:sNumber">
                    <b>${python:view.orderItemList[repeat['value'].index]}</b>:
                      <tal:s_n repeat="sn python:json.loads(value)"> ${sn}<span tal:condition="not:repeat/sn/end"> / </span>  </tal:s_n>
                </tal:sn>
                <tal:default case="default">
                    <b>${python:view.orderItemList[repeat['value'].index]}</b>: ${value}
                </tal:default>
            </li>
<hr>
        </ul>
    </tr>



    <tr><h4>訂單資訊</h4>
        <ul>
            <li tal:repeat="item python:view.getOrderInfo(orderId)">
                <b>${python:view.orderInfoList[repeat['item'].index]}</b>: ${item}
            </li>
        </ul>
    </tr>
</table>





</metal:content-core>
</metal:content-core>

</body>
</html>

